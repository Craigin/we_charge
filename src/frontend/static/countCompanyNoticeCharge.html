<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>WEB打印控件LODOP的样例二:打印当前页面的内容</title>

    <script language="javascript" src="LodopFuncs.js"></script>
</head>

<body>
    <h2><font color="#009999">演示如何打印当前页面的内容：</font>
</h2>
    <br>
    <div >
      <div id="form1">
        <div style="float: left;width: 50%">
          <div style="text-align: center;margin: 12px;font-size: 22px; font-weight: bold;">
            通知单
          </div>
          <div style="padding-left: 4%">
            用户:  dddddddd
          </div>
          <div style="padding-left: 4%;line-height: 1.5;margin-bottom: 4px;word-break: break-all;">
            <span style="width: 16px;display: inline-block;"></span>
            <span>贵用户17年12月份水费、电费、卫生管理费及垃圾处理费等12312.9元，请于2017/12/3日前把欠费交清，逾期缴费者将按应交总额每天增收滞纳金0.5%计算并采取相应的措施。</span>
          </div>
          <div style="padding-left: 4%;margin-bottom: 6px;">
            <span style="width: 54px;text-align-last: justify;display: inline-block">开户行</span>: 深圳平安银行南新路支行
          </div>
          <div style="padding-left: 4%;margin-bottom: 6px;">
            <span style="width: 54px;text-align-last: justify;display: inline-block">名称</span>: 深圳市南源实业股份有限公司水电一部
          </div>
          <div style="padding-left: 4%;margin-bottom: 6px;">
            <span style="width: 54px;text-align-last: justify;display: inline-block">账号</span>: 11233132
          </div>
          <div style="text-align: right; margin-right: 16px;margin-bottom: 6px;">
            南 园 村 水 电 组
          </div>
          <div style="text-align: right; margin-right: 16px">
            2018年1月12日
          </div>
        </div>
        <div style="float: left;width: 50%">
          <div style="text-align: center;margin: 12px;font-size: 22px; font-weight: bold;">
            通知单
          </div>
          <div style="padding-left: 4%">
            用户:  dddddddd
          </div>
          <div style="padding-left: 4%;line-height: 1.5;margin-bottom: 4px;word-break: break-all;">
            <span style="width: 16px;display: inline-block;"></span>
            <span>贵用户17年12月份水费、电费、卫生管理费及垃圾处理费等12312.9元，请于2017/12/3日前把欠费交清，逾期缴费者将按应交总额每天增收滞纳金0.5%计算并采取相应的措施。</span>
          </div>
          <div style="padding-left: 4%;margin-bottom: 6px;">
            <span style="width: 54px;text-align-last: justify;display: inline-block">开户行</span>: 深圳平安银行南新路支行
          </div>
          <div style="padding-left: 4%;margin-bottom: 6px;">
            <span style="width: 54px;text-align-last: justify;display: inline-block">名称</span>: 深圳市南源实业股份有限公司水电一部
          </div>
          <div style="padding-left: 4%;margin-bottom: 6px;">
            <span style="width: 54px;text-align-last: justify;display: inline-block">账号</span>: 11233132
          </div>
          <div style="text-align: right; margin-right: 16px;margin-bottom: 6px;">
            南 园 村 水 电 组
          </div>
          <div style="text-align: right; margin-right: 16px">
            2018年1月12日
          </div>
        </div>
      </div>
    </div>
    <div style="clear: both">
        <p>1：若只打印《表单一》,看一下<a href="javascript:prn1_preview()">打印预览</a>,可<a href="javascript:prn1_print()">直接打印</a>也可
        <a href="javascript:prn1_printA()">选择打印机</a>打印。
        <br><br>
        <p>
          3：若打印整个页面,看看<a href="javascript:prn3_preview()">打印预览</a>。
          <br><br> 本例要点是用Document的innerHTML方法把打印目标的超文本送给控件。
          <p><a href="PrintSampIndex.html">&lt;&lt;回样例目录</a>
        </p>
            <script language="javascript" type="text/javascript">
                var LODOP; //声明为全局变量
                function prn1_preview() {
                    CreateOneFormPage();
                    LODOP.PREVIEW();
                };

                function prn1_print() {
                    CreateOneFormPage();
                    LODOP.PRINT();
                };

                function prn1_printA() {
                    CreateOneFormPage();
                    LODOP.PRINTA();
                };

                function CreateOneFormPage() {
                    LODOP = getLodop();
                    LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_表单一");
                    LODOP.SET_PRINT_STYLE("FontSize", 18);
                    LODOP.SET_PRINT_STYLE("Bold", 1);
                    let strCenterStyle="<!DOCTYPE html><body><style/>table {margin: 0 auto}</style>";
                    // LODOP.ADD_PRINT_TEXT(50, 231, 260, 39, "打印页面部分内容");
                    LODOP.ADD_PRINT_HTM(0, 0, '100%', '100%', strCenterStyle + document.getElementById("form1").innerHTML);
                };

                function prn2_preview() {
                    CreateTwoFormPage();
                    LODOP.PREVIEW();
                };

                function prn2_manage() {
                    CreateTwoFormPage();
                    LODOP.PRINT_SETUP();
                };

                function CreateTwoFormPage() {
                    LODOP = getLodop();
                    LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_表单二");
                    LODOP.ADD_PRINT_RECT(70, 27, 634, 242, 0, 1);
                    LODOP.ADD_PRINT_TEXT(29, 236, 279, 38, "页面内容改变布局打印");
                    LODOP.SET_PRINT_STYLEA(2, "FontSize", 18);
                    LODOP.SET_PRINT_STYLEA(2, "Bold", 1);
                    LODOP.ADD_PRINT_HTM(88, 40, 321, 185, document.getElementById("form1").innerHTML);
                    LODOP.ADD_PRINT_HTM(87, 355, 285, 187, document.getElementById("form2").innerHTML);
                    LODOP.ADD_PRINT_TEXT(319, 58, 500, 30, "注：其中《表单一》按显示大小，《表单二》在程序控制宽度(285px)内自适应调整");
                };

                function prn3_preview() {
                    LODOP = getLodop();
                    LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_全页");
                    LODOP.ADD_PRINT_HTM(0, 0, "100%", "100%", document.documentElement.innerHTML);
                    LODOP.PREVIEW();
                };
            </script>

</body>

</html>
